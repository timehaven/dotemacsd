#+TITLE: Ryan Woodard's Emacs configuration
#+OPTIONS: toc:4 h:4
#+STARTUP: lognoterefile

* Remember 
- indirect buffers!
- http://angg.twu.net/emacs.html#eev
- ergoemacs http://ergoemacs.org/emacs/emacs_best_keyboard.html
- https://thepointsguy.com/2016/02/5-things-to-know-global-entry/
- https://github.com/nteract/sidecar
- https://ptgriffiths.wordpress.com/2017/02/05/jupyter-notebook-emacsipython-and-vimipython-integration/
- https://snarfed.org/dotfiles/.emacs
- https://github.com/zbskii/misc/blob/master/.emacs.d/init.el (Brett)
- http://www.howardism.org/
- https://github.com/winterTTr/ace-jump-mode
- http://doc.rix.si/cce/cce.html
- http://www.splode.com/~friedman/software/emacs-lisp/


* Notes, non elisp

We dearly thank [[http://sachachua.com][Sacha Chua]] for many ideas from [[http://sachachua.com/dotemacs][this file]], vision and
general great stuff.  She is wonderful.

* No external package dependencies
** General setup, preferences

#+BEGIN_SRC emacs-lisp :tangle yes
  (menu-bar-mode 1)                                   ;; -1 turns off
  (scroll-bar-mode -1)
  (column-number-mode 1)
  (fset 'yes-or-no-p 'y-or-n-p)
  (setq org-src-fontify-natively t)                   ;; fontify code blocks, I hope
  (add-hook 'text-mode-hook 'turn-on-auto-fill)       ;; auto-fill always on
  (setq custom-file "~/.emacs.d/custom-settings.el")
#+END_SRC

** Machine, OS

#+BEGIN_SRC emacs-lisp :tangle yes
  ;; check OS type
  (setq is-linux nil)
  (setq is-mac nil)
  (cond
   ((string-equal system-type "darwin") ; Mac OS X
    (progn
      (message "Mac OS X")
      (setq is-mac t)))
   ((string-equal system-type "gnu/linux") ; linux
    (progn
      (message "Linux")
      (setq is-linux t))))
#+END_SRC

** Emacs version

#+BEGIN_SRC emacs-lisp :tangle yes
  ;; check emacs version
  (if (version< emacs-version "25.1")
      ((message "Old Emacs, YMMV")
       (kill-emacs))
    (message "Why not try 26.1?"))
#+END_SRC

** Friendly greeting

#+BEGIN_SRC emacs-lisp :tangle yes
  (message "Spinning up %s@%s using %s"
	   system-name
	   user-login-name
	   ;;user-emacs-directory
	   user-init-file)
#+END_SRC

** Frame size, font (no colors yet).

#+BEGIN_SRC emacs-lisp :tangle yes
  ;;  t for a termcap frame (a character-only terminal),
  ;; ‘x’ for an Emacs frame that is really an X window,
  ;; ‘w32’ for an Emacs frame that is a window on MS-Windows display,
  ;; ‘ns’ for an Emacs frame on a GNUstep or Macintosh Cocoa display,

  ;; Readability counts.
  ;; `C-x C-+’ and ‘C-x C--’
  ;; C-x C-0 to reset.
  (when (eq is-linux t)
    ;; Readable font
    (when (eq window-system 'x)
      (set-face-attribute 'default nil :height 260)
      (add-to-list 'initial-frame-alist '(height . 55))
      (add-to-list 'initial-frame-alist '(width . 80))
      (add-to-list 'default-frame-alist '(height . 55))
      (add-to-list 'default-frame-alist '(width . 80))))

  (when (eq is-mac t)

    ;; Macbook built-in display.
    (when (eq window-system 'ns)
      ;; On Mac, use Command-t to bring up font menu.
      (set-face-attribute 'default nil :height 220)
      ;;(set-face-attribute 'default nil :height 240)
      (add-to-list 'initial-frame-alist '(height . 33))
      (add-to-list 'initial-frame-alist '(width . 80))
      (add-to-list 'default-frame-alist '(height . 33))
      (add-to-list 'default-frame-alist '(width . 80))))
#+END_SRC

** Who am I?

#+BEGIN_SRC emacs-lisp :tangle yes
  (setq user-full-name "Ryan Woodard")
  (when (eq user-login-name "ryan")
    (setq user-mail-address "ryan@timehaven.org"))
  (when (eq user-login-name 'rwoodard)
    (setq user-mail-address "rwoodard@appnexus.com"))
#+END_SRC

* package, use-package

#+BEGIN_SRC emacs-lisp :tangle yes
  (require 'package)
  (setq package-enable-at-startup nil)   ; To prevent initialising twice

  ;; Default  ("gnu" . "http://elpa.gnu.org/packages/")
  ;; add-to-list always adds element to beginning of list
  ;;  (unless t is after element to add).
  (add-to-list 'package-archives '("melpa stable" . "https://stable.melpa.org/packages/"))
  (add-to-list 'package-archives '("melpa" . "http://melpa.org/packages/"))
  (add-to-list 'package-archives '("elpy" . "https://jorgenschaefer.github.io/packages/"))

  (add-to-list 'package-archive-priorities '("elpy"         . 4))
  (add-to-list 'package-archive-priorities '("melpa"        . 3))
  (add-to-list 'package-archive-priorities '("melpa stable" . 2))
  (add-to-list 'package-archive-priorities '("gnu"          . 1))

  (message "***** package-initialize *****")
  (package-initialize)

  (unless (package-installed-p 'use-package)
    (message "***** package-refresh-contents *****")
    (package-refresh-contents)
    (package-install 'use-package))

  (eval-when-compile
    (message "***** require use-package *****")
    (require 'use-package))

  ;; https://github.com/jwiegley/use-package
  (setq use-package-verbose t)
#+END_SRC

#+RESULTS:
: t

* org
** Install Emacs, org-mode source and needed packages on debian-based
#+BEGIN_SRC sh
  sudo apt-get install emacs25-common-non-dfsg install-info \
       texi2html texinfo texinfo-doc-nonfree
  mkdir $HOME/.emacs.d/elisp && cd $HOME/.emacs.d/elisp
  git clone git://orgmode.org/org-mode.git
  cd org-mode && make
#+END_SRC

To update occasionally:

#+BEGIN_SRC sh nil
  ls
#+END_SRC

#+RESULTS:
: /Users/rwoodard/.emacs.d

#+BEGIN_SRC sh
  cd $HOME/elisp/org-mode && make up2
  git log  # to see what has changed
  git gc  # to clean things up, keep dir smaller
#+END_SRC

#+RESULTS:
| commit  | 342f48f1584393e058c74a1b6b66996e45b7dd16 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <rwoodard@appnexus.com>    |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Sun                                      | May                                  | 7                          |                       06:19:04 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Add     | org                                      | src                                  | block                      |                        motion, | creation |     funcs | bound   | to      | f     | keys |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | 18de91ffa8156b9ed92369fc4a63bf63884e7281 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <rwoodard@appnexus.com>    |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Thu                                      | May                                  | 4                          |                       17:24:08 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Add     | new                                      | shell,                               | terminal                   |                         helper |    stuff |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | 46e7bc485384af665a285782bcf0658effbbc460 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <rwoodard@appnexus.com>    |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Wed                                      | May                                  | 3                          |                       17:54:47 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Add     | elpy                                     | and                                  | shell                      |                          speed | commands |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | d39e4052992387511cdf3d4cce80700277cee951 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <rwoodard@appnexus.com>    |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Tue                                      | May                                  | 2                          |                       19:35:40 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Add     | new                                      | files                                | at                         |                          start |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | 9516790242de5495c13cb26fb4c760b078ba9e9a |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <rwoodard@appnexus.com>    |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Tue                                      | May                                  | 2                          |                       19:26:34 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| More    | session                                  | and                                  | blah                       |                           work |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | d30fd36ccfa12d65e78bed24bc459dacdf162259 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <ryan@timehaven.org>       |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Mon                                      | May                                  | 1                          |                       22:04:06 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Change  | colors                                   |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | 2fe2800b2cc668285f3f4ed2b6f2dcabc33a9ca0 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <rwoodard@appnexus.com>    |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Mon                                      | May                                  | 1                          |                       17:05:15 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| More    | speed                                    | command                              | src                        |                          block |   stuff, |       not | working |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | b7bfbfd45d180e88bb5ce099cbe7701ef798cec9 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <rwoodard@appnexus.com>    |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Mon                                      | May                                  | 1                          |                       09:24:18 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Add     | speed                                    | key                                  | for                        |                            src |  blocks, |     widen |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | f17280d12e4b71715f6c28c2aa19c7ed11764a24 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <ryan@timehaven.org>       |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Sun                                      | Apr                                  | 30                         |                       22:27:05 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Remove  | menu                                     | and                                  | scroll                     |                           bars |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | 9b1e35a0f775e3f21b78c3a9301e5d49c552b6e9 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Merge:  | 42bac8a                                  | a16d52b                              |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <rwoodard@appnexus.com>    |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Sun                                      | Apr                                  | 30                         |                       22:19:49 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Merge   | branch                                   | 'master'                             | of                         | github.com:timehaven/dotemacsd |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | 42bac8a9fddc6345b110cf53a8f32ad3d843d685 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <rwoodard@appnexus.com>    |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Sun                                      | Apr                                  | 30                         |                       22:18:50 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Merge   | with                                     | home                                 |                            |                                |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | a16d52bbfaf1236569945edafc8618bdbac72b58 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <ryan@timehaven.org>       |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Sun                                      | Apr                                  | 30                         |                       22:17:01 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Add     | dashboard                                |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | a6773ab33a136f927ba4269b4eb4a25b4e8ba5d0 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <rwoodard@appnexus.com>    |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Sun                                      | Apr                                  | 30                         |                       01:05:16 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Remove  | all                                      | elpa                                 | dependency                 |                                |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | 87ec75c72210fe5858e854f09ebe696f70c3d0a5 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <rwoodard@appnexus.com>    |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Sun                                      | Apr                                  | 30                         |                       00:50:41 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Ignore  | more                                     | things                               |                            |                                |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | e835672daee20185a02cd567079767c11399334d |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <rwoodard@appnexus.com>    |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Sun                                      | Apr                                  | 30                         |                       00:49:28 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Remove  | lots                                     | of                                   | elpa                       |                         things |     that |    should | not     | be      | saved |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | 5d401f37a64d7217ae3aa2494d0afbe6d726c47d |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <rwoodard@appnexus.com>    |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Sun                                      | Apr                                  | 30                         |                       00:44:27 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Change  | to                                       | real                                 | init.el                    |                           that |    calls | emacs.org |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | dca75c1b8cbeb144381dae3039a2ca812f8ba990 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <rwoodard@appnexus.com>    |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Fri                                      | Apr                                  | 28                         |                       16:27:08 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Make    | it                                       | better                               | each                       |                            day |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | 9d045b8127882b33ca2852bb24b45a7f98e629af |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <rwoodard@appnexus.com>    |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Fri                                      | Apr                                  | 28                         |                       09:15:30 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Improve | use-package                              | and                                  | auto                       |                           load |       of |     files | at      | startup |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | 4860d94fbd83a609101682c7a962e69c3996f93c |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <rwoodard@appnexus.com>    |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Thu                                      | Apr                                  | 27                         |                       17:18:42 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Tweak   |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | f8907ed1ab8542a03e86602ab40f1b543bf77836 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <ryan@timehaven.org>       |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Wed                                      | Apr                                  | 26                         |                       23:08:48 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Fix     | helm-org                                 | interaction                          |                            |                                |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | 63a5efef12874610781edc7e14616d3fbf7838ae |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <ryan@timehaven.org>       |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Wed                                      | Apr                                  | 26                         |                       22:44:13 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Remove  | helm,                                    | it                                   | conflicts                  |                           with |   latest |       org | (for    | now)    |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | 9392c221123e261ce32a3f9324b3368ec13726cd |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <rwoodard@appnexus.com>    |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Wed                                      | Apr                                  | 26                         |                       17:56:28 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Add     | helm                                     |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | ed05c134805e039b69b704e7ed0a75939ce5b2c0 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <ryan@timehaven.org>       |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Wed                                      | Apr                                  | 26                         |                       07:49:59 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Add     | *.pyc                                    | to                                   | .gitignore                 |                                |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | cae6d4af8db9f318302b690a50afec616285a682 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <rwoodard@appnexus.com>    |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Tue                                      | Apr                                  | 25                         |                       17:09:28 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Back    | to                                       | trying                               | out                        |                          jedi, |  improve |    python | src     | block   |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | 3e2ac9e4e5d7d2da5e1b6dbac643cb617f071dcc |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <rwoodard@appnexus.com>    |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Tue                                      | Apr                                  | 25                         |                       10:41:48 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Add     | some                                     | file                                 | jumping,                   |                            org |   refile |     stuff |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | 402bba2d36dbba3d270f2d4c151d6445effac7bb |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <ryan@timehaven.org>       |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Tue                                      | Apr                                  | 25                         |                       08:47:05 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Remove  | jedi,                                    | add                                  | elpy,                      |                            try |       to |       get | org     | babel   | eval  | to   | work | (not | yet) |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | 0bf2109a8f97d5cc768f87509f4b46b8587133c2 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <ryan@timehaven.org>       |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Mon                                      | Apr                                  | 24                         |                       19:11:08 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Add     | x                                        | frame                                | attributes                 |                                |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | eaca996006d0b57713d9f325031d8b52a6dad23f |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <rwoodard@appnexus.com>    |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Mon                                      | Apr                                  | 24                         |                       18:55:36 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Fix     | org                                      | info                                 | load                       |                         order, |      add |   initial | Python  |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | f2d2ec2592a8c7dc2bcc29304a0774ce48d13793 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <rwoodard@appnexus.com>    |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Mon                                      | Apr                                  | 24                         |                       15:13:14 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Tweak   |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | b686e8351680e5a9160c3a6bb5776a2db99ed97b |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <rwoodard@appnexus.com>    |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Mon                                      | Apr                                  | 24                         |                       15:00:15 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Add     | tangle                                   | file                                 |                            |                                |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | 77de9ed2a580b7ef0b0610936c02796df05dbf6f |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <ryan@timehaven.org>       |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Mon                                      | Apr                                  | 24                         |                       13:44:15 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Add     | some                                     | keys                                 | and                        |                         colors |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | 4ccaf5b74dbbe5600e051d3c71643e4b67666d99 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <ryan@timehaven.org>       |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Mon                                      | Apr                                  | 24                         |                       13:31:35 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Install | on                                       | new                                  | machine                    |                                |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | 3a30bad5f58b66b78f4087c61f9dcdc9407e47e1 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | The                                      | Guest                                | <guest@john.timehaven.net> |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Mon                                      | Apr                                  | 24                         |                       13:07:54 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Add     | magit                                    | options                              |                            |                                |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | f795e5b9b17617ec26d009fcdc1b786d26b565e3 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | The                                      | Guest                                | <guest@john.timehaven.net> |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Mon                                      | Apr                                  | 24                         |                       11:56:14 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Add     | new                                      | info                                 | path,                      |                          magit |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | 7b8651ce7a4ab50f6cf07c58aad13aa9c873a41d |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | The                                      | Guest                                | <guest@john.timehaven.net> |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Mon                                      | Apr                                  | 24                         |                       10:03:23 |     2017 |      -700 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Use     | Sacha                                    | config                               | paradigm                   |                                |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | 8aede5f01a1a81eb6682fa4c2588b25c371581be |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <rwoodard@appnexus.com>    |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Fri                                      | May                                  | 2                          |                       16:28:05 |     2014 |     +0000 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Tweak   | f5.                                      |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | cefa357cac928f943495bba5bdd7cd36ac332b95 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <rwoodard@appnexus.com>    |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Wed                                      | Apr                                  | 30                         |                       18:03:26 |     2014 |     +0000 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Cleaner | packaging.                               |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | fb9fe1039032c02f85e18ce78286e0bcfb629662 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | Ryan                                     | Woodard                              | <github@timehaven.org>     |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Sat                                      | Jan                                  | 11                         |                       02:30:30 |     2014 |     +0000 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Begin.  |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| commit  | 6890c28eb32693d716438466038e727c8f854d37 |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Author: | timehaven                                | <timehaven@users.noreply.github.com> |                            |                                |          |           |         |         |       |      |      |      |      |
| Date:   | Fri                                      | Jan                                  | 10                         |                       09:59:31 |     2014 |      -800 |         |         |       |      |      |      |      |
|         |                                          |                                      |                            |                                |          |           |         |         |       |      |      |      |      |
| Initial | commit                                   |                                      |                            |                                |          |           |         |         |       |      |      |      |      |

** Version check

#+BEGIN_SRC emacs-lisp :tangle yes
(defun my/check-org ()
  (message (concat "org-version " org-version))
  (if (version< org-version "9.0")
      (progn
	(message "Yuck!  Old org!")
	(kill-emacs))
    (message "Why not try 9.1 now?")))
(my/check-org)
#+END_SRC

** use-package org, config babel load lang, ob-ipython, org element
#+BEGIN_SRC emacs-lisp :tangle yes
  (setq jupyter-console-exec (substitute-in-file-name
			      "$HOME/local/miniconda3/envs/py36/bin/jupyter"))
  (message "***** use-package ob-ipython *****")
  (use-package ob-ipython
    :ensure t
    :config
    (setq ob-ipython-command jupyter-console-exec)
    (setq ob-ipython-kernel-extra-args '("--simple-prompt")))
#+END_SRC

#+BEGIN_SRC ipython :session
print("Hello, world!")
a = 5
#+END_SRC

#+RESULTS:
:RESULTS:
Hello, world!
:END:

#+BEGIN_SRC ipython :session
  %matplotlib inline
  import matplotlib.pyplot as plt
  import numpy as np
#+END_SRC

#+BEGIN_SRC ipython :session
  %matplotlib osx
  import matplotlib.pyplot as plt
  import numpy as np
#+END_SRC

#+RESULTS:
:RESULTS:
:END:

#+BEGIN_SRC ipython :session :results output drawer
plt.plot([1, 2, 3])  
#+END_SRC

#+RESULTS:
:RESULTS:
:END:

#+BEGIN_SRC emacs-lisp :tangle yes
  (message "***** use-package org *****")
  (use-package org
    :load-path "~/.emacs.d/elisp/org-mode/lisp"  ;; redundant, at this point
    :ensure ob-ipython
    :config
    (progn

      ;; Some of this stuff is for ob-ipython, scimax, etc.
      (setq org-startup-with-inline-images t)
      (add-hook 'org-babel-after-execute-hook 'org-display-inline-images)

      (org-babel-do-load-languages
       'org-babel-load-languages
       '(
	 ;; (dot . t)
	 ;;   (ditaa . t)
	 (emacs-lisp . t)
	 (python . t)
	 (ipython . t)
	 (sh . t)
	 ;; (sqlite . t)
	 ;; (http . t)
	 ;; (ledger . t)
	 (shell . t)
	 ;; (R . t)))
	 ))
      ))

  (defun my-org-confirm-babel-evaluate (lang body)
    (and
    (not (string= lang "ipython"))
    (not (string= lang "sh"))
    (not (string= lang "emacs-lisp"))
    ))  ; don't ask for these languages
  (setq org-confirm-babel-evaluate 'my-org-confirm-babel-evaluate)

  (message "***** use-package org-element *****")
  (use-package org-element
    :load-path "~/.emacs.d/elisp/org-mode/lisp")
#+END_SRC

#+RESULTS:

Sacha doesn't want to get distracted by the same code in the other
window, so I want org src to use the current window.

#+begin_src emacs-lisp :tangle yes
  (setq org-src-window-setup 'current-window)
#+end_src

** org mode structure templates (=<s= things)
#+BEGIN_SRC emacs-lisp :tangle yes
  (setq org-structure-template-alist
       '(("s" "#+BEGIN_SRC ?\n\n#+END_SRC" "<src lang=\"?\">\n\n</src>")
          ("e" "#+BEGIN_EXAMPLE\n?\n#+END_EXAMPLE" "<example>\n?\n</example>")
          ("q" "#+BEGIN_QUOTE\n?\n#+END_QUOTE" "<quote>\n?\n</quote>")
          ("v" "#+BEGIN_VERSE\n?\n#+END_VERSE" "<verse>\n?\n</verse>")
          ("c" "#+BEGIN_COMMENT\n?\n#+END_COMMENT")
	 ("p" "#+BEGIN_SRC ipython :session :async t\n?\n#+END_SRC" "<src lang=\"ipython\">\n?\n</src>")
          ;;("p" "#+BEGIN_PRACTICE\n?\n#+END_PRACTICE")
          ("l" "#+BEGIN_SRC emacs-lisp :tangle yes\n?\n#+END_SRC" "<src lang=\"emacs-lisp\">\n?\n</src>")
          ("L" "#+latex: " "<literal style=\"latex\">?</literal>")
          ("h" "#+BEGIN_HTML\n?\n#+END_HTML" "<literal style=\"html\">\n?\n</literal>")
          ("H" "#+html: " "<literal style=\"html\">?</literal>")
          ("a" "#+BEGIN_ASCII\n?\n#+END_ASCII")
          ("A" "#+ascii: ")
          ("i" "#+index: ?" "#+index: ?")
          ("I" "#+include %file ?" "<include file=%file markup=\"?\">")))
#+END_SRC

#+RESULTS:
| s | #+BEGIN_SRC ? |

** speed commands, src blocks
#+BEGIN_SRC emacs-lisp :tangle yes
  ;; (setq org-use-speed-commands t)  ;; Way cool!
  ;; For example, to activate speed commands when the point is on any
  ;; star at the beginning of the headline, you can do this:
  (setq org-use-speed-commands
	(lambda () (and (looking-at org-outline-regexp) (looking-back "^\**"))))

  (add-to-list 'org-speed-commands-user '("N" org-narrow-to-subtree))
  (add-to-list 'org-speed-commands-user '("W" widen))

  ;; Default speed commands already available:
  ;;  F   org-next-block
  ;;  B   org-previous-block
  ;; But do not work when at front of src block like
  ;;  #+BEGIN_SRC sh
  ;; etc.
  ;; So add 'F' and 'B' to speed keys when on src block.
  ;;
  ;; Basis of code from
  ;; http://kitchingroup.cheme.cmu.edu/blog/category/orgmode/2/
  (defun my/org-next-block-centered ()
    (interactive)
    (org-next-block)
    (recenter-top-bottom))

  (setq org-speed-commands-src-blocks
	'(
	  ;;("f" . my/org-next-block-centered)
	  ("F" . org-babel-next-src-block)
	  ("B" . org-babel-previous-src-block)))

  (defun org-speed-src-blocks (keys)
    ;; (and point-at-beginning-of-line is-a-src-block)
    (when (and (bolp) (looking-at org-babel-src-block-regexp))
      (cdr (assoc keys org-speed-commands-src-blocks))))

  (add-hook 'org-speed-command-hook 'org-speed-src-blocks)
#+end_src

#+RESULTS:
| org-speed-src-blocks | org-speed-command-activate | org-babel-speed-command-activate |

** skinning, looking good
http://www.howardism.org/Technical/Emacs/orgmode-wordprocessor.html
#+BEGIN_SRC emacs-lisp :tangle yes
  (setq org-hide-emphasis-markers t)
  (font-lock-add-keywords 'org-mode
			  '(("^ +\\([-*]\\) "
			     (0 (prog1 () (compose-region (match-beginning 1) (match-end 1) "•"))))))
  (use-package org-bullets
    :ensure t
    :config
    (progn
      (add-hook 'org-mode-hook (lambda () (org-bullets-mode 1)))))
#+END_SRC
* External packages
** Magit - nice git interface

#+begin_src emacs-lisp :tangle yes
  (message "***** use-package magit *****")
  (use-package magit
    :ensure t)
  (global-set-key (kbd "C-x g") 'magit-status)
  (global-set-key (kbd "C-x M-g") 'magit-dispatch-popup)
  (setq global-magit-file-mode t)
#+end_src

** Mode line format

Display a more compact mode line

#+BEGIN_SRC emacs-lisp :tangle yes
  (message "***** use-package smart-mode-line *****")
  (use-package smart-mode-line
    :ensure t)
#+END_SRC

#+RESULTS:
** parens and such
#+BEGIN_SRC emacs-lisp :tangle yes
  (message "***** use-package smartparens *****")
  (use-package smartparens
    :ensure t
    :config
    (progn
      (require 'smartparens-config)
      (add-hook 'emacs-lisp-mode-hook 'smartparens-mode)
      (add-hook 'emacs-lisp-mode-hook 'show-smartparens-mode)))
#+END_SRC
** srspeedbar (speedbar in same frame)
#+BEGIN_SRC emacs-lisp :tangle yes
  (message "***** use-package sr-speedbar *****")
  (use-package sr-speedbar
    :ensure t)
    ;; :config
    ;; (progn
    ;;   (require 'smartparens-config)
    ;;   (add-hook 'emacs-lisp-mode-hook 'smartparens-mode)
    ;;   (add-hook 'emacs-lisp-mode-hook 'show-smartparens-mode)))
#+END_SRC
** writeroom mode (for concentrating)
#+BEGIN_SRC emacs-lisp :tangle yes
  (message "***** use-package writeroom-mode *****")
  (use-package writeroom-mode
    :ensure visual-fill-column
    :ensure t)
#+END_SRC
** yas snippets (from Sacha)
    #+begin_src emacs-lisp :tangle yes
      (use-package yasnippet
        :ensure t
        :diminish yas-minor-mode
        :init (yas-global-mode)
        :config
        (progn
          (yas-global-mode)
          ;; (add-hook 'hippie-expand-try-functions-list 'yas-hippie-try-expand)
          (setq yas-key-syntaxes '("w_" "w_." "^ "))
	  ;; Will be problem with yas upgrade...
          (setq yas-installed-snippets-dir "~/.emacs.d/elpa/yasnippet-20170418.351/snippets")
          (setq yas-expand-only-for-last-commands nil)
          (yas-global-mode 1)
          ;; (bind-key "\t" 'hippie-expand yas-minor-mode-map)
          (add-to-list 'yas-prompt-functions 'shk-yas/helm-prompt)
      ;;        (global-set-key (kbd "C-c y") (lambda () (interactive)
      ;;                                         (yas/load-directory "~/elisp/snippets")))
      ))
#+end_src

#+RESULTS:
: t

From http://emacswiki.org/emacs/Yasnippet

#+begin_src emacs-lisp :tangle yes
  (defun shk-yas/helm-prompt (prompt choices &optional display-fn)
    "Use helm to select a snippet. Put this into `yas/prompt-functions.'"
    (interactive)
    (setq display-fn (or display-fn 'identity))
    (if (require 'helm-config)
        (let (tmpsource cands result rmap)
          (setq cands (mapcar (lambda (x) (funcall display-fn x)) choices))
          (setq rmap (mapcar (lambda (x) (cons (funcall display-fn x) x)) choices))
          (setq tmpsource
                (list
                 (cons 'name prompt)
                 (cons 'candidates cands)
                 '(action . (("Expand" . (lambda (selection) selection))))
                 ))
          (setq result (helm-other-buffer '(tmpsource) "*helm-select-yasnippet"))
          (if (null result)
              (signal 'quit "user quit!")
            (cdr (assoc result rmap))))
      nil))
#+end_src

From https://github.com/pcmantz/elisp/blob/master/my-bindings.el

#+begin_src emacs-lisp :tangle no
  (setq default-cursor-color "gray")
  (setq yasnippet-can-fire-cursor-color "purple")

  ;; It will test whether it can expand, if yes, cursor color -> green.
  (defun yasnippet-can-fire-p (&optional field)
    (interactive)
    (setq yas--condition-cache-timestamp (current-time))
    (let (templates-and-pos)
      (unless (and yas-expand-only-for-last-commands
                   (not (member last-command yas-expand-only-for-last-commands)))
	(setq templates-and-pos (if field
                                    (save-restriction
                                      (narrow-to-region (yas--field-start field)
							(yas--field-end field))
                                      (yas--templates-for-key-at-point))
                                  (yas--templates-for-key-at-point))))
      (and templates-and-pos (first templates-and-pos))))

  (defun my/change-cursor-color-when-can-expand (&optional field)
    (interactive)
    (when (eq last-command 'self-insert-command)
      (set-cursor-color (if (my/can-expand)
                            yasnippet-can-fire-cursor-color
                          default-cursor-color))))

  (defun my/can-expand ()
    "Return true if right after an expandable thing."
    (or (abbrev--before-point) (yasnippet-can-fire-p)))

                                          ; As pointed out by Dmitri, this will make sure it will update color when needed.
  (remove-hook 'post-command-hook 'my/change-cursor-color-when-can-expand)

  (defun my/insert-space-or-expand ()
    "For binding to the SPC SPC keychord."
    (interactive)
    (condition-case nil (or (my/hippie-expand-maybe nil) (insert "  "))))
#+end_src

* helm
#+BEGIN_SRC emacs-lisp :tangle yes
  (message "***** use-package helm *****")
  (use-package helm
    :ensure t
    :diminish helm-mode
    :init
    (progn
      (require 'helm-config)
      (setq helm-candidate-number-limit 100)
      ;; From https://gist.github.com/antifuchs/9238468
      (setq helm-idle-delay 0.0 ; update fast sources immediately (doesn't).
	    helm-input-idle-delay 0.01  ; this actually updates things
					  ; reeeelatively quickly.
	    helm-yas-display-key-on-candidate t
	    helm-quick-update t
	    helm-M-x-requires-pattern nil
	    helm-ff-skip-boring-files t)
      (helm-mode))
    :bind (("C-c h" . helm-mini)
	   ("C-h a" . helm-apropos)
	   ("C-x C-b" . helm-buffers-list)
	   ("C-x b" . helm-buffers-list)
	   ("M-y" . helm-show-kill-ring)
	   ("M-x" . helm-M-x)
	   ("C-x c o" . helm-occur)
	   ("C-x c s" . helm-swoop)
	   ("C-x c y" . helm-yas-complete)
	   ("C-x c Y" . helm-yas-create-snippet-on-region)
	   ("C-x c b" . my/helm-do-grep-book-notes)
	   ("C-x c SPC" . helm-all-mark-rings)))
  (ido-mode -1) ;; Turn off ido mode in case I enabled it accidentally
#+END_SRC

#+RESULTS:

* Python
** Make jupyter default shell
#+BEGIN_SRC emacs-lisp :tangle no

  (setq jupyter-console-exec (substitute-in-file-name
			      "$HOME/local/miniconda3/envs/py36/bin/jupyter"))

  ;; (setq python-shell-interpreter jupyter-console-exec
  ;;       python-shell-interpreter-args "console --existing --simple-prompt")

  ;; python-shell-interpreter-args "--simple-prompt")
#+END_SRC

#+BEGIN_SRC emacs-lisp :tangle no
(ob-ipython--launch-driver "ryan")
(org-babel-ipython-initiate-session "ryan")
#+END_SRC

#+BEGIN_SRC ipython :session :async t
  print('babba')
  a = 'flathh'
  import time
  time.sleep(5)
  print('hi there')
  #plt.plot([1, 2,3 ])
#+END_SRC

#+RESULTS:
:RESULTS:
babba
hi there
:END:


** scimax, its version of ob-ipython

#+BEGIN_SRC emacs-lisp :tangle yes
  ;; (setq my-jupyter-args " console --existing --simple-prompt")
    ;; (setq my-jupyter-args " console --simple-prompt")
    ;; (setq ob-ipython-command (concat jupyter-console-exec my-jupyter-args))
      ;;(setq ob-ipython-command jupyter-console-exec)

    ;; see org-babel stuff for ipython in Org section above
    ;; http://kitchingroup.cheme.cmu.edu/blog/2017/01/29/ob-ipython-and-inline-figures-in-org-mode/#disqus_thread
    ;; Intermittent silliness!
    ;;(require 'cl-lib)  ;; Might be needed with 'loop' error.

    ;; (add-to-list 'load-path "~/.emacs.d/elisp/scimax")
    ;; (require 'scimax-org-babel-ipython)

;; Provides functions for working with files
(use-package f)

;; Functions for working with strings
(use-package s)

(use-package cl)
(use-package cl-lib)


  (load-file "/Users/rwoodard/.emacs.d/elisp/scimax/scimax-org-babel-ipython.el")
  (require 'scimax-org-babel-ipython)

  ;; (message "***** use-package scimax-org-babel-ipython *****")
  ;; (use-package scimax-org-babel-ipython
  ;;   :load-path "~/.emacs.d/elisp/scimax"
  ;;   :ensure t
  ;;   :config
  ;;   (setq ob-ipython-kernel-extra-args '("--simple-prompt")))

#+END_SRC

#+BEGIN_SRC ipython :session :results output drawer
a = 79302
print(a)
#+END_SRC

#+RESULTS:
:RESULTS:
79302
:END:

#+BEGIN_SRC ipython :session
print('hi')
#+END_SRC

** elpy
#+BEGIN_SRC emacs-lisp :tangle no
  ;; (setq elpy-rpc-backend "jedi")
  ;; Use conda env in shell from which Emacs was started!
  (use-package elpy
    :ensure t
    :bind (:map elpy-mode-map
		([f12] . elpy-shell-send-region-or-buffer)))
  (elpy-enable)
#+END_SRC

#+RESULTS:
| elpy-rpc--disconnect |

* Colors
** material
#+BEGIN_SRC emacs-lisp :tangle yes
  (use-package material-theme
    :ensure ;TODO: 
    :config
    ;;(load-theme 'material-light t)
    (load-theme 'material t)
    )
#+END_SRC

#+RESULTS:
: t

** Sacha solarized
Sacha says:

#+BEGIN_QUOTE :tangle yes
Set up a light-on-dark color scheme.  I like light on dark because I
find it to be more restful. The color-theme in ELPA was a little odd,
though, so we define some advice to make it work. Some things still
aren't quite right.
#+END_QUOTE

#+BEGIN_SRC emacs-lisp :tangle no
  ;; (defadvice color-theme-alist (around sacha activate)
  ;;   (if (ad-get-arg 0)
  ;;       ad-do-it
  ;;     nil))
  (message "***** use-package color-theme and solarized *****")
  (use-package color-theme
    :ensure t)
  (use-package color-theme-solarized
    :ensure t)
  (defun my/setup-color-theme ()
    (interactive)
    (color-theme-solarized-dark)
    ;; (set-face-foreground 'secondary-selection "darkblue")
    ;; (set-face-background 'secondary-selection "lightblue")
    ;; (set-face-background 'font-lock-doc-face "black")
    ;; (set-face-foreground 'font-lock-doc-face "wheat")
    ;; (set-face-background 'font-lock-string-face "")
    ;; (set-face-background 'font-lock-string-face "black")
    ;; (set-face-foreground 'org-todo "green")
    ;; (set-face-background 'org-todo "black")
    )
  (eval-after-load 'color-theme (my/setup-color-theme))
#+END_SRC

#+BEGIN_QUOTE :tangle no
I sometimes need to switch to a lighter background for screenshots.
For that, I use =color-theme-vim=.

Some more tweaks to solarized:
#+END_QUOTE

NOTE:  not tangled!

#+BEGIN_SRC emacs-lisp :tangle no
  (when window-system
    (custom-set-faces
     '(erc-input-face ((t (:foreground "antique white"))))
     '(helm-selection ((t (:background "ForestGreen" :foreground "black"))))
     '(org-agenda-clocking ((t (:inherit secondary-selection :foreground "black"))) t)
     '(org-agenda-done ((t (:foreground "dim gray" :strike-through nil))))
     '(org-done ((t (:foreground "PaleGreen" :weight normal :strike-through t))))
     '(org-clock-overlay ((t (:background "SkyBlue4" :foreground "black"))))
     '(org-headline-done ((((class color) (min-colors 16) (background dark)) (:foreground "LightSalmon" :strike-through t))))
     '(outline-1 ((t (:inherit font-lock-function-name-face :foreground "cornflower blue"))))))
#+END_SRC
** org block faces
Testing these with kaolin theme...need work.
#+BEGIN_SRC emacs-lisp :tangle no
  (setq org-src-block-faces '(("emacs-lisp" (:background "#363636"))
			      ("ipython" (:background "#363636"))
			      ("python" (:background "#363636"))))
#+END_SRC
** kaolin
#+BEGIN_SRC emacs-lisp :tangle no
  (use-package kaolin-theme 
    :ensure t)
  ;;(color-theme-kaolin)
#+END_SRC

* Utility functions
** unfill paragraph
#+BEGIN_SRC emacs-lisp :tangle yes
;;; Stefan Monnier <foo at acm.org>. It is the opposite of fill-paragraph
    (defun unfill-paragraph (&optional region)
      "Takes a multi-line paragraph and makes it into a single line of text."
      (interactive (progn (barf-if-buffer-read-only) '(t)))
      (let ((fill-column (point-max))
            ;; This would override `fill-column' if it's an integer.
            (emacs-lisp-docstring-fill-column t))
        (fill-paragraph nil region)))
#+END_SRC

* Dashboard at startup
https://github.com/rakanalh/emacs-dashboard
#+BEGIN_SRC emacs-lisp :tangle yes
  (use-package dashboard
    :ensure t
    :config
    (dashboard-setup-startup-hook))
#+END_SRC
* Initial files to load
#+BEGIN_SRC emacs-lisp :tangle yes
  ;; (mapcar (lambda (path) (find-file path))
  ;; 	(list 
  ;; 	 "~/.emacs.d/init.el"
  ;; 	 "~/.emacs.d/zunused/ryan.org"
  ;; 	 "~/.emacs.d/emacs.org"
  ;; 	 ))
#+END_SRC

* shell, term, etc.
#+BEGIN_SRC emacs-lisp :tangle yes
;; I like zsh from non-emacs, but keep things simple within emacs.
(setq explicit-shell-file-name "/bin/bash")
#+END_SRC
(add-to-list 'load-path "~/.emacs.d")
(load-library "terms_and_shells")
* My function key bindings
** Summary table
*** old

|     | f                | shift                               | meta            | ctrl             | super | hyper |
|-----+------------------+-------------------------------------+-----------------+------------------+-------+-------|
| f1  | only             | info                                | speedbar        | go to this table |       |       |
| f2  | split v          | split h                             | org ctl c ctl c |                  |       |       |
| f3  | bury             |                                     | prev src block  |                  |       |       |
| f4  | kill             |                                     | new block above |                  |       |       |
| f5  | other buffer     |                                     |                 |                  |       |       |
| f6  | other window     |                                     |                 |                  |       |       |
| f7  | eshell           |                                     |                 |                  |       |       |
| f8  | buffers menu     |                                     |                 |                  |       |       |
| f9  |                  | beg of buffer                       | new block below |                  |       |       |
| f10 | find file        | end of buffer                       | org next block  | tmm menu         |       |       |
| f11 | save-buffer      |                                     | org ctl c ctl c |                  |       |       |
| f12 | eval-last-sexp   |                                     | eval and step   | eval-last-sexp   |       |       |
|     | python send line | org-edit-special, org-edit-src-exit |                 |                  |       |       |
|     | sh send line     |                                     |                 |                  |       |       |
|-----+------------------+-------------------------------------+-----------------+------------------+-------+-------|

*** current

Global

|     | f                           | shift                         | meta             | ctrl           |
|-----+-----------------------------+-------------------------------+------------------+----------------|
| f1  | only window                 | kill window                   | go to this table |                |
| f2  | split vertical (top/bottom) | split horizontal (left/right) |                  |                |
| f3  | bury buffer                 | kill buffer                   |                  |                |
| f4  |                             |                               |                  |                |
| f5  | other buffer                | browse url                    |                  |                |
| f6  | other window                | other window, reverse         |                  |                |
| f7  |                             | [python?  eshell?  shell?]    |                  |                |
| f8  | buffers menu                | speedbar toggle               | tmm menu         | info           |
| f9  |                             | beg of buffer                 |                  |                |
| f10 |                             | end of buffer                 |                  |                |
| f11 | save-buffer                 | find file                     |                  |                |
| f12 |                             |                               |                  | eval-last-sexp |
|-----+-----------------------------+-------------------------------+------------------+----------------|

org, org-src

|     | f                                         | shift               | meta                       | ctrl |
|-----+-------------------------------------------+---------------------+----------------------------+------|
| f1  |                                           |                     |                            |      |
| f2  |                                           |                     |                            |      |
| f3  |                                           |                     |                            |      |
| f4  | org C-c C-c                               | C-c C-c, next block | org C-c C-c c, new block   |      |
|     | org src Python C-c C-c buffer             |                     |                            |      |
| f5  |                                           |                     |                            |      |
| f6  |                                           |                     |                            |      |
| f7  |                                           |                     |                            |      |
| f8  |                                           |                     |                            |      |
| f9  | prev src block                            |                     | new block above            |      |
| f10 | next src block                            |                     | new block below            |      |
| f11 |                                           |                     |                            |      |
| f12 | (org, org src, el) eval line              | f12 then step       | org:     org-edit-special  |      |
|     | (org, org src, py) python send line       |                     | org src: org-edit-src-exit |      |
|     | (org, org src, sh) org src, sh: send line |                     |                            |      |
|-----+-------------------------------------------+---------------------+----------------------------+------|

** code
#+BEGIN_SRC emacs-lisp :tangle yes
  ;; See examples at bottom of this file of ways to set keys.

  ;; Global.

  (global-set-key [end]
		  'move-end-of-line)
  (global-set-key [home]
		  'move-beginning-of-line)
  (global-set-key (kbd "s-s")
		  'isearch-forward)  ;; Mac command key
  (global-set-key (kbd "s-r")
		  'isearch-backward)  ;; Mac command key

  (add-hook 'isearch-mode-hook
	    (lambda ()

	      (define-key isearch-mode-map (kbd "s-s")
		  'isearch-repeat-forward)
	      (define-key isearch-mode-map (kbd "s-r")
		  'isearch-repeat-backward)
		  ))

  ;; Make only one window.
  (global-set-key [f1]
		  'delete-other-windows)

  ;; Make this window go away.
  (global-set-key [S-f1]
		  'delete-window)

  ;; Go to table of key bindings.
  (global-set-key [M-f1] 
		  (lambda ()
		    (interactive)
		    (bookmark-jump "keys")
		    (recenter-top-bottom 1)))

  ;; Split window in half (top and bottom).
  (global-set-key [f2]
		  (lambda ()
		    (interactive)
		    (split-window-vertically)
		    (other-window 1)))

  ;; Split window in half (left and right).
  (global-set-key [S-f2]
		  (lambda ()
		    (interactive)
		    (split-window-horizontally)
		    (other-window 1)))

  ;; Bury buffer.
  (global-set-key [f3]
		  'bury-buffer)

  ;; Kill buffer (require two key presses since it's a kill).
  (global-set-key [S-f3]
		  'kill-buffer)

  ;; Switch to most recent buffer.
  (global-set-key [f5]
		  (lambda ()
		    (interactive)
		    (switch-to-buffer nil)))

  ;; JFGI
  (global-set-key [S-f5]
		  'browse-url)

  ;; Go to next window.
  (global-set-key [f6] 
		  (lambda ()
		    (interactive)
		    (other-window 1)))

  ;; Go to previous window.
  (global-set-key [S-f6] 
		  (lambda ()
		    (interactive)
		    (other-window -1)))

  ;; helm version of buffers.
  (global-set-key [f8]
		  'helm-mini)

  ;; speedbar
  (global-set-key [S-f8]
		  'sr-speedbar-toggle)

  ;; menu that a mouse would find.
  (global-set-key [M-f8]
		  'tmm-menubar)

  ;; Info!
  (global-set-key [C-f8]
		  'info)

  ;; Top and bottom of buffer.
  (global-set-key [S-f9]
		  'beginning-of-buffer)

  (global-set-key [S-f10]
		  'end-of-buffer)

  (global-set-key [S-f11]
		  'helm-find-files)

  (global-set-key [f11]
		  'save-buffer)

  (global-set-key [C-f12]
		  'eval-last-sexp)



  (add-hook 'org-mode-hook
	    (lambda ()

	      (define-key org-mode-map [f4]
		'org-ctrl-c-ctrl-c)

	      (define-key org-mode-map [f9]
		'org-previous-block)

	      (define-key org-mode-map [f10]
		'org-next-block)

	      (define-key org-mode-map [M-f9]
		'insert-new-block-same-as-current)

	      (define-key org-mode-map [M-f10]
		'insert-new-block-same-as-current-below)
	    
	      (define-key org-mode-map [S-f4]
		  (lambda ()
		    (interactive)
		    (org-ctrl-c-ctrl-c)
		    (org-next-block)))
	    
	      (define-key org-mode-map [M-f4]
		  (lambda ()
		    (interactive)
		    (org-ctrl-c-ctrl-c)
		    (insert-new-block-same-as-current-below)))

	      (define-key org-mode-map [M-f12]
		'org-edit-special)
	    
	      ))


  (add-hook 'org-src-mode-hook
	    (lambda ()

	      ;; C-c C-c, standard Python mode, no elpy
	      (define-key org-src-mode-map [f4]
		'python-shell-send-buffer)

	      (define-key org-src-mode-map [M-f12]
		'org-edit-src-exit)
	    
	      ))


  (defun my/eval-line (mode-specific-eval)
    "Send entire current line to sh, elisp, python or whatever."
    (let ((start (line-beginning-position))
	  (end (line-end-position)))
      (funcall mode-specific-eval start end)))


  (add-hook 'sh-mode-hook
	    (lambda()

	      (define-key sh-mode-map [f12]
		(lambda ()
		  (interactive)
		  (my/eval-line 'sh-execute-region)))
	    
	      (define-key sh-mode-map [S-f12]
		(lambda ()
		  (interactive)
		  (my/eval-line 'sh-execute-region)
		  (next-line)
		  (end-of-line)))

	      ))


  (add-hook 'python-mode-hook
	    (lambda()

	      (define-key python-mode-map [f12]
		(lambda ()
		  (interactive)
		  (my/eval-line 'python-shell-send-region)))
	    
	      (define-key python-mode-map [S-f12]
		(lambda ()
		  (interactive)
		  (my/eval-line 'python-shell-send-region)
		  (next-line)
		  (end-of-line)))

	      ))


  (add-hook 'emacs-lisp-mode-hook
	    (lambda()
	    
	      (define-key emacs-lisp-mode-map [f12]
		(lambda ()
		  (interactive)
		  (my/eval-line 'eval-region)))
	    
	      ))



  ;; Cool things in term mode.
  ;;
  ;; ‘C-c C-l’
  ;; ‘C-c C-o’


  ;;;;
  ;;
  ;; Examples.
  ;;
  ;; From Info, examples of ways to set global keys:
  ;;
  ;; (global-set-key (kbd "C-c y") 'clipboard-yank)
  ;; (global-set-key (kbd "C-M-q") 'query-replace)
  ;; (global-set-key (kbd "<f5>") 'flyspell-mode)
  ;; (global-set-key (kbd "C-<f5>") 'linum-mode)
  ;; (global-set-key (kbd "C-<right>") 'forward-sentence)
  ;; (global-set-key (kbd "<mouse-2>") 'mouse-save-then-kill)

  ;; (global-set-key "\C-x\M-l" 'make-symbolic-link)

  ;; <TAB>
  ;; (global-set-key "\C-x\t" 'indent-rigidly)

  ;; (global-set-key [?\C-=] 'make-symbolic-link)
  ;; (global-set-key [?\M-\C-=] 'make-symbolic-link)
  ;; (global-set-key [?\H-a] 'make-symbolic-link)
  ;; (global-set-key [f7] 'make-symbolic-link)
  ;; (global-set-key [C-mouse-1] 'make-symbolic-link)

  ;; (global-set-key [?\C-z ?\M-l] 'make-symbolic-link)
#+END_SRC

** help
  consp((src-block (:language "ipython" :switches nil :parameters
  ":session" :begin 33927 :end 33986 :number-lines nil
  :preserve-indent nil :retain-labels t :use-labels t :label-fmt nil
  :value "print(\"In ipyB!\")\n" :post-blank 2 :post-affiliated 33927
  :parent nil)))

